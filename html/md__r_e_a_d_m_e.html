<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WRIMS3: :steam_locomotive: WRIMS Engine</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">WRIMS3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__r_e_a_d_m_e.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">:steam_locomotive: WRIMS Engine </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md42"></a></p>
<p>The compute engine for the **W**ater **R**esource **I**ntegrated **M**odeling System.</p>
<dl class="section warning"><dt>Warning</dt><dd>This is the development repository for a pre-release version of WRIMS <b>3</b>. Is you are wanting to submit an issue, or feature request for WRIMS <b>2</b> (which is the latest version of WRIMS), please do that through the <a href="https://github.com/CentralValleyModeling/wrims">WRIMS 2 Repo</a>.</dd></dl>
<p><a href="https://water.ca.gov/Library/Modeling-and-Analysis/Modeling-Platforms/Water-Resource-Integrated-Modeling-System">WRIMS</a> is DWR's generalized water resources modeling system for evaluating operational alternatives of large, complex river basins. WRIMS integrates a simulation language for flexible operational criteria specification, a linear programming solver for efficient water allocation decisions, and graphics capabilities for ease of use. These combined capabilities provide a comprehensive and powerful modeling tool for water resource systems simulation.</p>
<dl class="section note"><dt>Note</dt><dd>This is the development repository for the WRIMS 3 engine. The official distribution of WRIMS is available from the <a href="https://water.ca.gov/Library/Modeling-and-Analysis/Modeling-Platforms/Water-Resource-Integrated-Modeling-System">DWR Library</a> Additionally, the <a href="https://github.com/CentralValleyModeling/wrims-gui"><span class="tt">wrims-gui</span></a> repository contains the code, tests, and documentation for the GUI Application that most users are familiar with. <span class="tt">wrims-gui</span> uses the Java modules in this repo.</dd></dl>
<p>This repository contains the code, tests, and developer documentation for the Java module <span class="tt">wrims-core</span>. WRIMS-core is a Java module used to run WRESL+ based models. WRIMS-core can be run as a command-line application from a batch process or shell script.</p>
<p>Prior to the present revison of the WRIMS build system, the equivalent of WRIMS-core was a jar file named <span class="tt">WRIMSv2.jar</span>.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md43"></a>
Getting Started</h1>
<ol type="1">
<li><b>Clone the repository:</b> <div class="fragment"><div class="line">git clone https://github.com/CentralValleyModeling/wrims-engine.git</div>
</div><!-- fragment --></li>
</ol>
<h1 class="doxsection"><a class="anchor" id="autotoc_md44"></a>
RUNNING HEADLESS WRIMS ENGINE COMPUTE</h1>
<p>The WRIMS engine can be run headless (without the GUI) using the <span class="tt">wrims-core</span> jar along with all dependency jars and libs. This is useful for running batch processes or automated tests.</p>
<p>Here are the required steps to run a headless compute with the WRIMS engine jar directly:</p>
<ol type="1">
<li>Build the wrims-core module. This will create a jar file in the <span class="tt">wrims-core/build/libs</span> directory and the copy the dependent jars into <span class="tt">wrims-core/build/tmp/libs</span>. <div class="fragment"><div class="line">./gradlew :wrims-core:build</div>
</div><!-- fragment --></li>
<li>Run the "getNatives" task in the wrims-core module. This will download all the required dll files into the <span class="tt">wrims-core/build/tmp/x64</span> directory. <div class="fragment"><div class="line">./gradlew :wrims-core:getNatives</div>
</div><!-- fragment --></li>
<li>Clone the run_wrims_study_example.bat file in the root directory of the wrims-engine folder and update the project directory and config file paths. <div class="fragment"><div class="line">@echo off</div>
<div class="line">REM PROJECT SETTINGS: PROJECT_DIR, and CONFIG_FILE variables as needed.</div>
<div class="line">set PROJECT_DIR=J:\wrims\projects\dcr2023</div>
<div class="line">set CONFIG_FILE=study.config</div>
<div class="line"> </div>
<div class="line">REM Set the JAVA_HOME environment variable to the path of your java 21 JDK</div>
<div class="line">set JAVA_HOME=&quot;J:\java\jdk\jdk_21.0.8_temurin&quot;</div>
<div class="line"> </div>
<div class="line">set temp_wrims2=&quot;.\foo&quot;</div>
<div class="line"> </div>
<div class="line">REM Add the required DLLs to the PATH. Do not change if this if run from the wrims-engine root directory.</div>
<div class="line">set PATH=%PATH%;wrims-core\build\tmp\x64</div>
<div class="line"> </div>
<div class="line">REM Add the external libraries to the PATH. Do not change.</div>
<div class="line">set PATH=%PATH%;%PROJECT_DIR%\Run\External</div>
<div class="line"> </div>
<div class="line">REM Set the main class to run. This is the entry point for the WRIMS application. Do not change when running from wrims-engine root.</div>
<div class="line">set MAIN_CLASS=wrimsv2.components.ControllerBatch</div>
<div class="line">set WRIMS_CORE_JAR=&quot;wrims-core\build\libs\*&quot;</div>
<div class="line">set WRIMS_CORE_DEPENDENCIES=&quot;wrims-core\build\tmp\libs\*&quot;</div>
<div class="line"> </div>
<div class="line">%JAVA_HOME%\bin\java -Xmx4096m -Xss1024K -cp &quot;%WRIMS_CORE_JAR%;%WRIMS_CORE_DEPENDENCIES%&quot; %MAIN_CLASS% -config=%PROJECT_DIR%\%CONFIG_FILE%</div>
<div class="line">pause</div>
</div><!-- fragment --></li>
<li>Run the batch file from a terminal or double-click it to execute the bat file. <div class="fragment"><div class="line">run_project.bat</div>
</div><!-- fragment --></li>
</ol>
<h1 class="doxsection"><a class="anchor" id="autotoc_md45"></a>
Dependabot Configuration</h1>
<p>This repository uses Dependabot to keep dependencies up to date. The configuration file is located at <span class="tt">.github/dependabot.yml</span>.</p>
<p>The current configuration checks for updates to dependencies weekly.</p>
<p>Dependabot will automatically create pull requests for dependency updates, which can then be reviewed and merged by the specified reviewers. It is currently configured to check for updates to Gradle dependencies and GitHub Actions workflows.</p>
<p>The default reviewers for dependency update pull requests are configured in the <span class="tt">.github/CODEOWNERS</span> file.</p>
<p>More information about configuring Dependabot can be found in the <a href="https://docs.github.com/en/code-security/dependabot/dependabot-version-updates/configuring-dependabot-version-updates">Dependabot configuration documentation</a>.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md46"></a>
Understanding Dependabot Scheduling and PR Timing</h2>
<hr  />
<h3 class="doxsection"><a class="anchor" id="autotoc_md48"></a>
1. Dependabot schedules are <em>best-effort</em>, not precise</h3>
<ul>
<li>When you set <span class="tt">schedule.interval</span> and <span class="tt">schedule.time</span>, that’s treated as “run sometime around this time,” not a strict cron.</li>
<li>GitHub’s docs note that it may not start exactly at the scheduled time—there’s a job queue that can be earlier or later depending on load.</li>
<li>Seeing 9:20, 10:20, etc. is pretty normal—it’s the system spreading out runs.</li>
</ul>
<hr  />
<h3 class="doxsection"><a class="anchor" id="autotoc_md50"></a>
2. Multiple runs at once</h3>
<p>Dependabot sometimes makes multiple attempts in quick succession when:</p>
<ul>
<li>It detects multiple ecosystems (npm, gradle, docker, etc.) → one job per ecosystem.</li>
<li>It encounters errors and retries.</li>
<li>It had a backlog (maybe your repo was newly enabled) and caught up with several updates in bursts.</li>
</ul>
<hr  />
<h3 class="doxsection"><a class="anchor" id="autotoc_md52"></a>
3. PR creation is <b>delayed from the update check</b></h3>
<p>Dependabot does two phases:</p>
<ol type="1">
<li><b>Update check</b> (scans for new versions, resolves manifests).</li>
<li><b>PR creation/update</b> (opens or rebases PRs).</li>
</ol>
<p>The scan might happen in the morning, but PR creation often lags until later (sometimes hours). GitHub queues PR creation separately, and sometimes updates don’t get turned into visible PRs until the following day (especially for large dependency graphs).</p>
<hr  />
<h3 class="doxsection"><a class="anchor" id="autotoc_md54"></a>
4. Midnight PRs</h3>
<p>That lines up with GitHub’s backend batching → Dependabot may only generate or finalize PRs after internal processing finishes. You’ll often see the “Dependabot created a PR” timestamp not match when the update job ran.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md56"></a>
SonarQube in-IDE Plugin Setup</h1>
<p>To set up SonarQube analysis in your IDE, follow these steps:</p><ol type="1">
<li><b>Install SonarLint Plugin:</b><ul>
<li>For IntelliJ IDEA: Go to <span class="tt">File &gt; Settings &gt; Plugins</span>, search for "SonarQube for IDE", and install it.</li>
<li>For Eclipse: Go to <span class="tt">Help &gt; Eclipse Marketplace</span>, search for "SonarQube for IDE", and install it.</li>
</ul>
</li>
<li><b>Configure SonarQube Connection:</b><ul>
<li>Open the SonarQube for IDE plugin settings in your IDE.<ul>
<li>For IntelliJ IDEA: <span class="tt">File &gt; Settings &gt; Tools &gt; SonarQube for IDE</span>.</li>
<li>For Eclipse: <span class="tt">Window &gt; Show View &gt; Other &gt; SonarQube &gt; SonarQube Bindings</span>.</li>
</ul>
</li>
<li>Create a token for the DWR-CVM organization.<ul>
<li>Add Connection to SonarQube organization.<ul>
<li>For IntelliJ IDEA: Go to <span class="tt">File &gt; Settings &gt; Tools &gt; SonarQube for IDE</span> and press the <span class="tt">+</span> button in the <span class="tt">Connections to SonarQube</span> section.</li>
<li>For Eclipse: Use the SonarQube Bindings panel to add a new connection by right-clicking in the view and selecting "New Connection...".</li>
</ul>
</li>
<li>Select "SonarQube Cloud" on the left, and name the connection whatever you want to (recommended: <span class="tt">dwr-cvm</span>). Click "Next"</li>
<li>Click "Create Token" ("Generate token" in Eclipse). This sends you to SonarQube, and if you have an account, will automatically create an authentication token for you if you allow the connection. Log in with your GitHub credentials if prompted.<ul>
<li>If using Eclipse, click "Next".</li>
</ul>
</li>
<li>Connect to the <span class="tt">dwr-cvm</span> organization.<ul>
<li>For IntelliJ IDEA: Click "Select another organization" if it doesn't already show up. Type in <span class="tt">dwr-cvm</span> into the window that appears. That should add it to the list of "Your Organizations". Click "Next".</li>
<li>For Eclipse: The organization name will already be populated. Click "Next". Name the connection whatever you want to (recommended: <span class="tt">dwr-cvm</span>) and click "Next".</li>
</ul>
</li>
<li>Choose whether you want to receive the SonarQube Cloud notifications. It is recommended to do so. Click "Next".</li>
<li>Finally,<ul>
<li>For IntelliJ IDEA: Click "Create".</li>
<li>For Eclipse: Click "Finish".</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><b>Bind the Project:</b><ul>
<li>After configuring the connection, bind your local project to the SonarQube project.<ul>
<li>For IntelliJ IDEA: To do so, open the SonarQube for IDE plugin settings in your IDE.<ul>
<li><span class="tt">File &gt; Settings &gt; Tools &gt; SonarQube for IDE &gt; Project Settings</span>. The "Project Settings" option may be hidden by a dropdown arrow next to the "SonarQube for IDE" option.</li>
<li>Then select the "Bind Project to SonarCloud" option.</li>
<li>Choose the connection you created in the previous steps in the "Connection" dropdown.</li>
<li>Next, select the "Search in list..." option to choose the project. If you don't see the WRIMS-Engine project, you can enter the project key manually in the "Project key" entry box. The project key for WRIMS-Engine is <span class="tt">CentralValleyModeling_wrims-engine</span>.</li>
<li>Click "Apply", then "OK" to close the settings window.</li>
</ul>
</li>
<li>For Eclipse: The binding menu is presented immediately after configuring the connection to the organization.<ul>
<li>Click "Add..." and select the project you want to bind. Then, click "Next".</li>
<li>Choose the SonarQube project to bind to. This should be the project key for WRIMS-Engine, which is <span class="tt">CentralValleyModeling_wrims-engine</span>. Click "Finish".</li>
</ul>
</li>
</ul>
</li>
<li>This will enable SonarQube analysis for your project in the IDE.</li>
</ul>
</li>
<li><b>Run Analysis:</b><ul>
<li>You can now run SonarQube analysis directly from your IDE.</li>
<li>The plugin will provide real-time feedback on code quality and potential issues as you write code. </li>
</ul>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
